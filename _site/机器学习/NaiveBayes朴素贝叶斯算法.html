<!DOCTYPE html>
<html>

<head>

    <link rel="shortcut icon" href="/static/jpg/myjpg.jpg"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <!-- Stylesheets -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/static/css/font-awesome.min.css" rel="stylesheet"/>
	<link href="/static/css/styles.css" rel="stylesheet"/>

    <script type="text/javascript" src="/static/js/jquery.min.js"></script>
    <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/js/modernizr.js"></script>
    <script type="text/javascript" src="/static/js/prefixfree.min.js"></script>
    <title>百哥么么哒|个人网站</title>

</head>


<body>
    <div class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <a class="navbar-brand brand" href="/">TTyb|个人网站</a>
        <div style="font-size: 6px;font-family: serif;text-decoration: none;">
            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" href="/">首页</a></li>
                <li><a class="navbar-brand" href="/topic">文章</a></li>
                <li><a class="navbar-brand" href="/category">分类</a></li>
                <li><a class="navbar-brand" href="/log/log">日志</a></li>
                <li><a class="navbar-brand" href="/guestbook">留言</a></li>
            </ul>
        </div>

        <div class="pull-right">
            <div style="font-size: 4px;font-family: serif;">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/contact" class="navbar-brand">联系方式</a>
                    </li>
                    <li>
                        <a data-toggle="dropdown" class="dropdown-toggle navbar-brand" href="#">友情链接<strong
                                class="caret"></strong></a>
                        <ul class="dropdown-menu container-fluid" style="border-radius: 6px 6px 6px 6px;">
                            <li><a href="http://www.cnblogs.com/TTyb">TTyb博客园</a></li>
                            <li><a href="http://www.cnblogs.com/nima">一只尼玛博客园</a></li>
                            <li><a href="https://github.com/TTyb">TTybGithub</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

    </div>
</div>

        <div class="container">
    <div class="page-header">
        <hr>
        <h3>NaiveBayes朴素贝叶斯算法</a></h3>
        <small>
            分类：机器学习
        </small>
        <h6 class="text-muted">作者:TTyb&nbsp;&nbsp;文章发表于 2017-01-16</h6>
        <br/>
        <p class="content text-overflow">
            <p>最为广泛的两种分类模型是 <a href="https://ttyb.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/ID3%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95.html">决策树模型(Decision Tree Model)</a> 和 <a href="">朴素贝叶斯模型（Naive Bayesian Model，NBM）</a>。</p>

<h3 id="朴素贝叶斯算法思路">朴素贝叶斯算法思路</h3>

<p>朴素贝叶斯法是基于 <code class="highlighter-rouge">贝叶斯定理与特征条件独立假设</code> 的分类方法，按照以前 <a href="https://ttyb.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/ID3%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95.html">决策树</a> 的数据，利用朴素贝叶斯进行分类：</p>

<p>假设存在如下一组信息：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">天气</th>
      <th style="text-align: center">气温</th>
      <th style="text-align: center">湿度</th>
      <th style="text-align: center">风</th>
      <th style="text-align: center">外出</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">no</td>
    </tr>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">no</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">no</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">no</td>
    </tr>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">yes</td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">no</td>
    </tr>
  </tbody>
</table>

<p>将上面的表格整理一下如下：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">天气</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">气温</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">湿度</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">风</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">外出</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">外出</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>假设所有的变量都是 <code class="highlighter-rouge">独立的</code> ，那么在以下天气中是否该外出：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>evidence = ['晴朗', '寒冷', '高', '有风']
</code></pre>
</div>

<p>将上述事件记为 <code class="highlighter-rouge">E</code> ， <code class="highlighter-rouge">E = [E1, E2, E3, E4]</code> , 当A、B相互独立时，由：</p>

<p><img src="http://images2015.cnblogs.com/blog/996148/201701/996148-20170116102921208-348877637.png" alt="" /></p>

<p>得贝叶斯定理：</p>

<p><img src="http://images2015.cnblogs.com/blog/996148/201701/996148-20170116102942692-1121172338.png" alt="" /></p>

<p>得：</p>

<p><img src="http://images2015.cnblogs.com/blog/996148/201701/996148-20170116103248474-799840570.png" alt="" /></p>

<p>又因为4个指标是相互独立的，所以：</p>

<p><img src="http://images2015.cnblogs.com/blog/996148/201701/996148-20170116103307786-367494930.png" alt="" /></p>

<p>带入计算得到：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>P(yes|E)*P(E)=2/9×3/9×3/9×3/9×9/14=0.0053
P(no|E)*P(E)=3/5×1/5×4/5×3/5×5/14=0.0206
</code></pre>
</div>

<p><code class="highlighter-rouge">外出概率：0.005291005291005291，不外出概率：0.02057142857142857，不适合外出！</code></p>

<h3 id="朴素贝叶斯算法代码">朴素贝叶斯算法代码</h3>

<p>朴素贝叶斯最重要的是构造 <code class="highlighter-rouge">训练样本</code> ，将表：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">天气</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">气温</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">湿度</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">风</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
      <th style="text-align: center">外出</th>
      <th style="text-align: center">yes</th>
      <th style="text-align: center">no</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">晴朗</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">高温</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">无风</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">外出</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td style="text-align: center">多云</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">温暖</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">正常</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">有风</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">下雨</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">寒冷</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>转化为字典：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>newcondition = {'高温': {'no': 0.4, 'yes': 0.2222222222222222}, '高': {'no': 0.8, 'yes': 0.3333333333333333}, '有风': {'no': 0.6, 'yes': 0.3333333333333333}, '温暖': {'no': 0.4, 'yes': 0.4444444444444444}, '多云': {'yes': 0.4444444444444444}, '寒冷': {'no': 0.2, 'yes': 0.3333333333333333}, '正常': {'no': 0.2, 'yes': 0.6666666666666666}, '下雨': {'no': 0.4, 'yes': 0.3333333333333333}, '无风': {'no': 0.4, 'yes': 0.6666666666666666}, '晴朗': {'no': 0.6, 'yes': 0.2222222222222222}}

newresult = {'no': 0.35714285714285715, 'yes': 0.6428571428571429}
</code></pre>
</div>

<p>最后相乘计算出概率即可：</p>

<div class="highlighter-rouge"><pre class="highlight"><code># 判断是否外出
def judgeresult(newcondition, newresult, weather):
    yesresult = 1
    noresult = 1
    for item in weather:
        # 外出的概率
        yesresult = yesresult * newcondition[item]["yes"]
        noresult = noresult * newcondition[item]["no"]

    yesresult = yesresult * newresult["yes"]
    noresult = noresult * newresult["no"]

    if yesresult &gt;= noresult:
        print("外出概率：" + str(yesresult) + "，不外出概率：" + str(noresult) + "，适合外出！")
    else:
        print("外出概率：" + str(yesresult) + "，不外出概率：" + str(noresult) + "，不适合外出！")
</code></pre>
</div>

<p>最终结果为：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>外出概率：0.005291005291005291，不外出概率：0.02057142857142857，不适合外出！
</code></pre>
</div>

<p>python的完成代码在我的github上面：</p>

<p><a href="https://github.com/TTyb/NaiveBayes">TTyb</a></p>

        </p>
    </div>
    <!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="http://localhost:4000/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/NaiveBayes%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%AE%97%E6%B3%95.html"
     data-title="NaiveBayes朴素贝叶斯算法" data-url="http://localhost:4000/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/NaiveBayes%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%AE%97%E6%B3%95.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"ttyb"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();

</script>
<!-- 多说公共JS代码 end -->

</div>


    
<a class="gototop" title="返回顶部" target="_self" href="#"></a>
<div class="container">
    <div id="footer" class="text-muted">
        <div style="font-family: 'Lato', sans-serif;">
            <div class="foo">
                <span class="letter" data-letter="T">T</span>
                <span class="letter" data-letter="T">T</span>
                <span class="letter" data-letter="y">y</span>
                <span class="letter" data-letter="b">b</span>
            </div>
        </div>
        <h3 style="font-size: 1.2em;font-family: KaiTi;">无聊就想打码 打码使我快乐</h3>
        <div style="font-size: 1.2em;font-family: KaiTi;">
            不用多久<br/>
            我就会升职加薪<br/>
            当上总经理<br/>
            出任CEO<br/>
            迎娶白富美<br/>
            走上人生巅峰
        </div>
    </div>
</div>
<footer id="footer">
    <ul class="icons">
        <li><a href="/contact" class="icon fa-qq"><span class="label">QQ</span></a></li>
        <li><a href="https://github.com/TTyb" class="icon fa-github"><span class="label">Github</span></a></li>
        <li><a href="/" class="icon fa-home"><span class="label">首页</span></a></li>
        <li><a href="http://www.cnblogs.com/TTyb/" class="icon fa-heart"><span class="label">博客园</span></a></li>
        <li><a href="/cloud" class="icon fa-cloud"><span class="label">云世界</span></a></li>
        <li><a href="/404" class="icon fa-map-signs"><span class="label">404</span></a></li>
    </ul>
    <p class="copyright">Copyright &copy; TTyb All rights reserved.</p>
</footer>

<script type="text/javascript" src="/static/js/jquery.gototop.min.js"></script>
<script type="text/javascript">
    $(function(){
            // $(".gototop").gototop();
            $(".gototop").gototop({
                position : 0,
                duration : 1250,
                visibleAt : 300,
                classname : "isvisible"
            });
        });
</script>


</body>
</html>
